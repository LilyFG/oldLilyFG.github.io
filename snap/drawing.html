<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Draw marker</title>
        <style media="screen">
        body {
        }
        </style>
        <script src="snap.svg-min.js"></script>
        <script>
		window.onload = function() {
			var s = Snap("#svg");
			//s.attr({ viewBox: "0 0 600 600" });
			
			(function() {

			  Snap.plugin( function( Snap, Element, Paper, global ) {

					Element.prototype.limitDrag = function( params ) {
							this.data('minx', params.minx ); this.data('miny', params.miny );
							this.data('maxx', params.maxx ); this.data('maxy', params.maxy );
							this.data('x', params.x );    this.data('y', params.y );
							this.data('ibb', this.getBBox() );
							this.data('ot', this.transform().local );
							this.drag( limitMoveDrag, limitStartDrag );
							return this;    
					};

					// this code is old and clunky now, and transform possibly in wrong order, so only use for simple cases
					function limitMoveDrag( dx, dy ) {
							var tdx, tdy;
							var sInvMatrix = this.transform().globalMatrix.invert();
							sInvMatrix.e = sInvMatrix.f = 0; 
							tdx = sInvMatrix.x( dx,dy ); tdy = sInvMatrix.y( dx,dy );

							this.data('x', +this.data('ox') + tdx);
							this.data('y', +this.data('oy') + tdy);
							if( this.data('x') > this.data('maxx') - this.data('ibb').width  ) 
									{ this.data('x', this.data('maxx') - this.data('ibb').width  ) };
							if( this.data('y') > this.data('maxy') - this.data('ibb').height ) 
									{ this.data('y', this.data('maxy') - this.data('ibb').height ) };
							if( this.data('x') < this.data('minx') ) { this.data('x', this.data('minx') ) };
							if( this.data('y') < this.data('miny') ) { this.data('y', this.data('miny') ) };
							this.transform( this.data('ot') + "t" + [ this.data('x'), this.data('y') ]  );
					};

					function limitStartDrag( x, y, ev ) {
							this.data('ox', this.data('x')); this.data('oy', this.data('y'));
					};
			  });
			})();
													


			
			line = s.polyline(100, 100, 500, 100).attr({ stroke: '#000', 'strokeWidth': 3})
			marker = s.polygon(300, 103, 310, 120, 290, 120).attr({fill: '#000'}).limitDrag({ x: 0, y: 0, minx: -200, miny: 0, maxx: 220, maxy: 0 })
			
			<!-- var move = function(dx) { -->
				<!-- bb = 300 -->
				<!-- if(100<=bb && bb<=500){ -->
					
					<!-- this.attr({ -->
						<!-- transform: this.data('origTransform') + (this.data('origTransform') ? "T" : "t") + [dx] -->
					<!-- }); -->
					<!-- var bb = this.getBBox();	 -->
					 
				<!-- } else {  -->
				
				<!-- stop() -->
				<!-- console.log(bb.cx) -->
				
				<!-- } -->
			<!-- } -->

			<!-- var start = function() { -->
					<!-- this.data('origTransform', this.transform().local ); -->
			<!-- } -->
			<!-- var stop = function() { -->
					<!-- console.log('finished dragging'); -->
			<!-- } -->

			<!-- marker.drag(move, start, stop ); -->
						
		}																				
   
		</script>
    </head>
	<body>
		<svg width="800" height="800" id="svg"></svg> 
    </body>
</html>
Â© 2017 GitHub, Inc.
